# Описание проекта
БД описывает интернет-магазин модной одежды, поддерживающий несколько магазинов-складов по стране. 

В базе хранятся данные на пользователей, категории всех типов (категория, автор коллекции, сезон, материал изготовления), список товаров и позиций на складах. Пользователи могут просматривать каталог как по всем возможным моделям, так и имеющиеся в наличии в конкретном магазине или включенные в коллекцию последнего сезона.

В базе хранятся корзины как зарегистрированных пользователей, так и незарегистрированных, по токену/сессии. Есть возможность отслеживать статус заказа.

Транзакции обеспечивают сохранность базы при оформлении заказа - нельзя заказать отсутствующий на складе товар или больше, чем есть на складе. 
## Структура таблиц
1. Категории товаров **category**
    - id
    - name 
    - root_category_id - id категории-родителя, иначе null
1. Материалы изготовления товаров **materials**
    - id
    - name
1. Размеры одежды **sizes**
    - id
    - name
1. Авторы коллекций **authors**
    - id
    - name
1. Сезоны коллекций **seasons**
    - id
    - name
    - from_date - дата начала сезона
    - to_date - дата завершения сезона
1. Список товаров **products**
    - id
    - category_id - внешний ключ category.id
    - name
    - price
    - material_id - внешний ключ materials.id
    - author_id - внешний ключ authors.id
    - season_id - внешний ключ seasons.id
    - deleted - bool значение, товар больше не продается
1. Юзеры, таблица с данными входа **users**
    - id
    - login
    - pass_hash - md5 хэш пароля
    - session - id сессии юзера
    - token - токен, выдающийся юзеру при входе с параметром "сохранить меня"
1. Профили, таблица с данными клиента **profiles**
    - id - внешний ключ users.id
    - name - Имя
    - surname - Фамилия
    - gender - Пол
    - birthday - ДР
    - email - электронный адрес
    - address - почтовый адрес
    - phone - телефон для связи
1. Магазины **stores**
    - id
    - city
    - address
    - open_time
    - close_time
1. Информация по товарам на складах магазинов **Warehouse**
    - id
    - store_id - внешний ключ stores.id
    - product_id - внешний ключ products.id
    - amount - количество позиций на складе
1. Возможные статусы заказа **order_statuses**
    - id
    - name (register, paid, on_package, sent, delivered, approved, lost, defective) - статус заказа, ограниченный выбор (оформлен, оплачен, передан на упаковку, отправлен, доставлен, получение подтверждено, утерян, поврежден)
1. Отдельные заказы **orders**
    - id
    - user_id - внешний ключ users.id
    - cost - стоимость всего заказа
    - store_id - внешний ключ stores.id
    - order_date - дата и время создания заказа
    - delivery_date - дата доставки заказа
    - status_id - внешний ключ order_statuses.id
1. Товары в заказах **order_products**
    - id
    - order_id - внешний ключ orders.id
    - product_id - внешний ключ products.id
    - amount - количество
    - price - цена, по которой был куплен продукт
    - cost - вычисляемый столбец стоимости
1. Корзина - **cart**
    - id
    - user_id - внешний ключ users.id
    - session - если корзина у незарегистрированного юзера, то она маркируется по сессии пользователя, user_id = null
    - product_id - внешний ключ products.id
    - amount - количество товара в корзине
1. ~~Логи изменения цен~~
1. ~~Избранное~~
1. ~~Ожидания товаров~~
## Представления
2. Список пользователей с возрастом и отслеживанием приближения ДР для скидок 
1. Список заказов пользователя
1. Корзина пользователя
## Триггеры
1. Невозможность уменьшить количество менее 1.
1. Логирование изменения цен
## Хранимые процедуры
1. Расчет количества дней до/после ДР